<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>EcoLink – Panel Organizaciones</title>
  <link rel="stylesheet" href="/css/DashboardPrincipal.css"/>
  <script type="module" src="/js/panelOrg.js" defer></script>
</head>

<body>

<header class="navbar">
  <div class="navbar-left">
    <img src="/assets/logo.png" class="logo-img" alt="EcoLink"/>
    <span class="app-title">Panel – Organizaciones y gobierno</span>
  </div>

  <div class="navbar-right" style="display:flex;gap:8px;align-items:center;">
    <!-- Mostrará “Ir a Ciudadanos” para org/admin; “Admin” solo para admin -->
    <a id="btnGoCitizen" href="/DashboardPrincipal.html" class="toolbar-btn" style="display:none">Ir a Ciudadanos</a>
    <a id="btnGoAdmin"   href="/admin.html"              class="toolbar-btn" style="display:none">Solo Admins</a>
  </div>
</header>

<main class="dashboard-panel">

  <section class="card" style="display:flex;gap:12px;align-items:center;flex-wrap:wrap">
    <div>
      <label>Corte:</label>
      <select id="periodo">
        <option value="7">Últimos 7 días</option>
        <option value="30" selected>Últimos 30 días</option>
        <option value="90">Últimos 90 días</option>
        <option value="365">Último año</option>
      </select>
    </div>
    <div>
      <label>Zona a ubicar:</label>
      <input id="filtroZona" placeholder="(todos) Ej. Monterrey"/>
    </div>
    <div>
      <label>Categoría:</label>
      <select id="filtroCategoria">
        <option value="">Todas</option>
        <option value="limpieza">Limpieza</option>
        <option value="reciclaje">Reciclaje</option>
        <option value="taller">Taller</option>
        <option value="donacion">Donación</option>
      </select>
    </div>
    <button id="btnAplicar">Aplicar</button>
    <button id="btnExport">Exportar CSV</button>
  </section>

  <!-- KPIs -->
  <section class="grid3">
    <div class="card kpi"><h4>Acciones totales</h4><div id="kpiTotal">—</div></div>
    <div class="card kpi"><h4>Acciones validadas</h4><div id="kpiValidadas">—</div></div>
    <div class="card kpi"><h4>Por categoría</h4><div id="kpiCategorias">—</div></div>
  </section>

  <!-- Líderes -->
  <section class="card">
    <h3>Líderes (más acciones en el período)</h3>
    <ol id="listaLideres"></ol>
  </section>

  <!-- Tabla de acciones -->
  <section class="card">
    <h3>Acciones (últimas)</h3>
    <table class="tabla">
      <thead>
        <tr>
          <th>Fecha</th><th>Autor</th><th>Categoría</th><th>Zona</th><th>Estado</th><th>Acciones</th>
        </tr>
      </thead>
      <tbody id="tablaAcciones"></tbody>
    </table>
    <div style="margin-top:8px;display:flex;gap:8px">
      <button id="btnMas">Cargar más</button>
    </div>
  </section>

</main>

<!-- =========== MODAL: Nueva organización (NUEVO) =========== -->
<div id="orgModal" class="modal oculto" aria-hidden="true">
  <div class="modal-card" role="dialog" aria-modal="true" aria-labelledby="orgTitle">
    <div class="modal-header">
      <h3 id="orgTitle">Nueva organización</h3>
      <button class="modal-close" id="orgClose" aria-label="Cerrar">✕</button>
    </div>

    <section class="org-form">
      <p id="orgMsg" class="perfil-msg oculto"></p>

      <label class="perfil-field">
        <span>Nombre de la organización</span>
        <input type="text" id="orgNombre" placeholder="Eco Monterrey" required />
      </label>

      <label class="perfil-field">
        <span>Municipio / Ciudad</span>
        <select id="orgMunicipio">
          <option value="">Selecciona…</option>
          <option>Abasolo</option><option>Agualeguas</option><option>Apodaca</option>
          <option>Cadereyta Jiménez</option><option>El Carmen</option><option>García</option>
          <option>Guadalupe</option><option>Monterrey</option><option>San Nicolás de los Garza</option>
          <option>Santa Catarina</option><option>Santiago</option>
        </select>
      </label>

      <label class="perfil-field">
        <span>Correo de contacto</span>
        <input type="email" id="orgCorreo" placeholder="contacto@dominio.com" />
      </label>

      <label class="perfil-field">
        <span>Teléfono</span>
        <input type="tel" id="orgTelefono" placeholder="81xxxxxxx" />
      </label>

      <label class="perfil-field">
        <span>Asignar propietario (email del usuario, opcional)</span>
        <input type="email" id="orgOwnerEmail" placeholder="owner@ejemplo.com" />
        <small>Si lo especificas, se cambiará su rol a organizacion y se vinculará a esta organización.</small>
      </label>

      <label class="perfil-field">
        <span>Descripción</span>
        <textarea id="orgDescripcion" rows="3" placeholder="Misión / enfoque…"></textarea>
      </label>

      <div class="file">
        <input class="input-file" type="file" id="orgLogoFile" accept="image/*" />
        <label for="orgLogoFile" class="fake">Logo</label>
        <span class="hint" id="orgLogoHint">PNG/JPG/WEBP • opcional</span>
      </div>

      <div id="orgLogoPreview" class="preview" style="display:none; gap:8px;">
        <img id="orgLogoImg" alt="preview logo" style="max-height:120px;border-radius:12px;">
      </div>
    </section>

    <div class="modal-actions">
      <button id="orgCancel" type="button" class="btn-light">Cancelar</button>
      <button id="orgSave" type="button" class="btn-primary">Crear</button>
    </div>
  </div>
</div>
<!-- =========== /MODAL =========== -->

<!-- Cárgalo DESPUÉS de firebase.js en cada página que necesite botones por rol -->
<script type="module" src="/js/roleNav.js"></script>


</body>
</html>
